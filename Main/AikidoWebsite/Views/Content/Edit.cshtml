@model AikidoWebsite.Web.Models.SeiteModel
@{
    ViewBag.Title = "Edit";
}

<style type="text/css">
    .wmd-input {
        width: 800px;
        height: 400px;
        border: 1px solid lightgrey;
        resize: none;
    }

    .wmd-preview {
        border: 1px dotted red;
        padding: 3px;
    }
</style>

<h2>Seite '@Model.Name' bearbeiten</h2>

@using (Html.BeginForm("Edit", "Content", FormMethod.Post, new { id = "contentForm" })) {
    
<div class="btn-group">
@*<input type="submit" value="speichern" class="btn btn-primary" />*@
<button class="btn btn-primary" onclick="save(); return false;">speichern</button>
<span class="btn disabled"><b>Revision:</b> @Model.Revision</span>
</div>
    
<div class="wmd-panel">
     <div id="wmd-button-bar"></div>   
     @Html.TextAreaFor(x => x.Markdown, new { @class = "wmd-input", id = "wmd-input" })
    </div>

    @Html.HiddenFor(x => x.Name)
    
}

<ul class="nav nav-tabs">
<li class="active"><a href="#vorschau" data-toggle="tab">Vorschau</a></li>
<li><a href="#markdown" data-toggle="tab">Markdown Hilfe</a></li>
</ul>

<div class="tab-content">

    <div class="tab-pane active" id="vorschau">
        <div id="wmd-preview" class="wmd-panel wmd-preview"></div>
    </div>
    <div class="tab-pane" id="markdown">
        Test

    </div>
</div>

@section Footer {
    <script type="text/javascript">
        $(function () {
            var converter = new markdownConv.Converter();
            var editor = new markdownConv.Editor(converter);

            editor.run();
        });

        function save() {
            var data = { Name: '@Model.Name', Markdown: $("Markdown").value };
            $.post("/Content/Edit", $("#contentForm").serialize())
            .done(function (data) {
                location.href = window.location.href.split('?')[0] + "?saved=true";
                //location.reload(true);
            })
            .fail(function () { });

        }
    </script>
}